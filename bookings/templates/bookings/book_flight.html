{% extends "base.html" %}

{% block content %}
<h2>Book Flight: {{ flight.flight_number }}</h2>

{% if error %}
  <p style="color: red;">{{ error }}</p>
{% endif %}

<!-- Legend -->
<div style="text-align: center; margin-bottom: 15px;">
  <span style="display:inline-block; width:20px; height:20px; background:green; border-radius:4px;"></span>
  <span> Available </span>&nbsp;&nbsp;
  <span style="display:inline-block; width:20px; height:20px; background:red; border-radius:4px;"></span>
  <span> Booked </span>
</div>

<form method="post" id="seatForm">
  {% csrf_token %}
  <table style="margin:auto; border-spacing: 15px;">
    {% for seat in seat_numbers %}
      {% if forloop.first %}<tr>{% endif %}

      {% if forloop.counter0|divisibleby:6 %}
        <tr> <!-- new row every 6 seats -->
      {% endif %}

      <td>
        {% if seat|stringformat:"s" in booked_seats %}
          <button type="button" disabled 
                  style="background-color: red; color: white; padding: 10px; border: none; border-radius: 4px; width:50px;">
            {{ seat }}
          </button>
        {% else %}
          <button type="submit" name="seat_no" value="{{ seat }}" 
                  onclick="return confirmBooking('{{ seat|escapejs }}')"
                  style="background-color: green; color: white; padding: 10px; border: none; border-radius: 4px; width:50px; cursor: pointer;">
            {{ seat }}
          </button>
        {% endif %}
      </td>

      {% if forloop.counter|divisibleby:3 %}
        <td style="width:30px;"></td> <!-- aisle gap -->
      {% endif %}

      {% if forloop.counter|divisibleby:6 %}
        </tr>
      {% endif %}
    {% endfor %}
  </table>
</form>

<!-- Confirmation Script -->
<script>
  function confirmBooking(seat) {
    return confirm('Confirm booking for seat ' + seat + '?');
  }
</script>


{% endblock %}